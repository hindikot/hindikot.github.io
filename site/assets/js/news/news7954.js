$(document).ready(function(){$.ajaxSetup({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')}});$(document).on('click','.news_check',function(){$("#news_check").fadeIn();var id=$(this).find('input').attr('data-news-id');var content=$(this).find('input').attr('data-news-title');var val=$(this).find('input').attr('checked')?1:0;$(".news_basket_btn").parent().attr('data-news-id',id);$(".news_basket_btn").parent().attr('data-val',val);var add=$(".news_basket_btn").attr('data-add');var remove=$(".news_basket_btn").attr('data-remove');(val==0)?$(".news_basket_btn").text(add):$(".news_basket_btn").text(remove);var addTitle=$("#news_check").find('.title').attr('data-content');var removeTitle=$("#news_check").find('.title').attr('data-remove');var price=$(this).find('input').attr('data-price');(val==0)?$("#news_check").find('.title').attr('data-add',addTitle):$("#news_check").find('.title').attr('data-add',removeTitle);$("#news_check").find(".price").html(price+' <span>AZN</span>');$("#news_check").find(".content").find('.text').html(content);});$(document).on('click','.news_lent',function(){var id=$(this).find('input').attr('data-news-id');var content=$(this).find('input').attr('data-news-title');var val=$(this).find('input').attr('checked')?1:0;$(".news_basket_btn").parent().attr('data-news-id',id);$(".news_basket_btn").parent().attr('data-val',val);var add=$(".news_basket_btn").attr('data-add');var remove=$(".news_basket_btn").attr('data-remove');(val==0)?$(".news_basket_btn").text(add):$(".news_basket_btn").text(remove);var addTitle=$("#news_check").find('.title').attr('data-content');var removeTitle=$("#news_check").find('.title').attr('data-remove');var price=$(this).find('input').attr('data-price');(val==0)?$("#news_check").find('.title').attr('data-add',addTitle):$("#news_check").find('.title').attr('data-add',removeTitle);$("#news_check").find(".price").html(price+' <span>AZN</span>');$("#news_check").find(".content").find('.text').html(content);});$(document).on('click','.news_basket_btn',function(){var id=$(this).parent().attr('data-news-id');var url=$(this).parent().attr('data-url');var val=$(this).parent().attr('data-val');$.ajax({type:"POST",dataType:"json",url:url,data:{id:id,val:val},beforeSend:function(){},success:function(response){$("#news_check").fadeOut();if(response.status===200){var news_id="#news_"+id;if(val==0){$(news_id+" input").prop('checked',true);}else{$(news_id+" input").prop('checked',false);}
var count=response.count>9?'+9':response.count;$(".basket-count span").html(count);}else{$("#info-modal").fadeIn();}},});});$(document).on('click','.subscription',function(){var id=$(this).parent().find('input').attr('data-news-id');$(".news_subscription_btn").parent().attr('data-news-id',id);var content=$(this).parent().find('input').attr('data-news-title');var price=$(this).parent().find('input').attr('data-price');var end_date=$(this).parent().find('input').attr("data-subscription");$("#subscription").find(".price").html(price+' <span>AZN</span>');$("#subscription").find(".content").find('.text').html(content);$("#subscription .end-date").html(end_date);$("#subscription").fadeIn();});$(document).on('click','.news_lent',function(){var id=$(this).find('input').attr('data-news-id');$(".news_subscription_btn").parent().attr('data-news-id',id);var content=$(this).find('.content').find('p').text();var price=$(this).find('input').attr('data-price');var end_date=$(this).attr("data-subscription");$("#subscription").find(".price").html(price+' <span>AZN</span>');$("#subscription").find(".content").find('.text').html(content);$("#subscription .end-date").html(end_date);});$(document).on('click','.news_subscription_btn',function(){var id=$(this).parent().attr('data-news-id');var url=$(this).parent().attr('data-url');$.ajax({type:"POST",dataType:"json",url:url,data:{id:id,},beforeSend:function(){},success:function(response){$("#subscription").fadeOut();if(response.status===200){window.location.assign(response.url);}else{$("#info-modal").fadeIn();}},});});$(document).on('click','.news_buy',function(e){$("#news_buy_check").fadeIn();var id=$(this).parent().find('input').attr('data-news-id');var title=$(this).parent().find('input').attr('data-news-title');$(".news_buy_btn").parent().attr('data-news-id',id);var price=$(this).parent().find('input').attr('data-price');$("#news_buy_check").find(".price").html(price+' <span>AZN</span>');$("#news_buy_check").find(".content").find('.text').html(title);});$(document).on('click','.news_lent_buy',function(){$("#news_buy_check").fadeIn();var id=$(this).find('input').attr('data-news-id');var content=$(this).find('.content').find('p').text();var price=$(this).find('input').attr('data-price');$(".news_buy_btn").parent().attr('data-news-id',id);$("#news_buy_check").find(".price").html(price+' <span>AZN</span>');$("#news_buy_check").find(".content").find('.text').html(content);});$(document).on('click','.news_buy_btn',function(){var id=$(this).parent().attr('data-news-id');var url=$(this).parent().attr('data-url');$.ajax({type:"POST",dataType:"json",url:url,data:{id:id,},beforeSend:function(){},success:function(response){$("#news_buy_check").fadeOut();if(response.status===200){$("#news_email_check").fadeIn();$("#news_email_check .close_modal").attr('href',response.data.url);$("#news_email_validate_check .close_modal").attr('href',response.data.url);$("#news_email .close_modal").attr('href',response.data.url);$("#news_email").find('.btn_verify').attr('data-id',response.data.id)
$("#news_email").find('.btn_verify').attr('data-type',response.data.type)
var count=response.count>9?'+9':response.count;$(".basket-count span").html(count);}else if(response.status===300){$("#balance-modal").fadeIn();}else{$("#info-modal").fadeIn();}},});});$(document).on("click",".news_email_modal",function(){$("#news_email_check").fadeOut();$("#news_email").fadeIn();});$(document).on("click",".news_email_replace",function(){$("#news_email_validate_check").fadeOut();$("#news_email").fadeIn();});$(document).on("click","#news_email .btn_verify",function(e){e.preventDefault();var url=$(this).parent().attr('data-url');var email=$("#news_email").find('input').val();var id=$(this).attr('data-id');var type=$(this).attr('data-type');$.ajax({type:"POST",dataType:"json",url:url,data:{email:email,id:id,type:type},beforeSend:function(){$("#news_email").fadeOut();$(".operation_loading").show();$(".loading").show();},success:function(response){setTimeout(function(){$(".operation_loading").hide();if(response.status===200){window.location.assign(response.url);}else{$("#info-modal").fadeIn();}},2000);},error:function(error){$("#news_email").fadeOut();$(".operation_loading").hide();$("#news_email_validate_check .text").remove();$("#news_email_validate_check").find('br').remove();var html='';$.each(error.responseJSON.errors,function(index,value){$.each(value,function(index,result){$("#news_email_validate_check").fadeIn();html+='<br><p class="text">'+result+'</p>';$("#news_email_validate_check .description").append(html)});});}});});});